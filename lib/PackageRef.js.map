{"version":3,"sources":["../src/PackageRef.js"],"names":["PackageRef","id","version","authors","description","summary","releaseNotes","tags","isInstalled","dependencies","mspec","toJson","json","pkg","package","metadata","res","split","length","dependency","map","d","feed","Promise","resolve","reject","Id","Version","Authors","Description","Summary","ReleaseNotes","Tags","Dependencies","e"],"mappings":";;;;;;;;AAAA;;;;AAEA;;;;;;;;;;IAEqBA,U;AAEnB,wBAAc;AAAA;;AACZ,SAAKC,EAAL,GAAU,EAAV;AACA,SAAKC,OAAL,GAAe,8BAAoB,GAApB,CAAf;AACA,SAAKC,OAAL,GAAe,EAAf;AACA,SAAKC,WAAL,GAAmB,EAAnB;AACA,SAAKC,OAAL,GAAe,EAAf;AACA,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKC,IAAL,GAAY,EAAZ;AACA,SAAKC,WAAL,GAAmB,KAAnB;AACA,SAAKC,YAAL,GAAoB,EAApB;AACD;;;;;4EAEsBC,K;;;;;;;;uBAEF,cAAIC,MAAJ,CAAWD,KAAX,C;;;AAAbE,oB;AACAC,mB,GAAMD,KAAKE,OAAL,CAAaC,QAAb,CAAsB,CAAtB,C;AAENC,mB,GAAM,IAAIhB,UAAJ,E;;AACVgB,oBAAIf,EAAJ,GAASY,IAAIZ,EAAJ,CAAO,CAAP,CAAT;AACAe,oBAAId,OAAJ,GAAc,8BAAoBW,IAAIX,OAAJ,CAAY,CAAZ,CAApB,CAAd;AACAc,oBAAIb,OAAJ,GAAcU,IAAIV,OAAlB;AACAa,oBAAIZ,WAAJ,GAAkBS,IAAIT,WAAJ,CAAgB,CAAhB,CAAlB;AACAY,oBAAIX,OAAJ,GAAcQ,IAAIR,OAAJ,CAAY,CAAZ,CAAd;AACAW,oBAAIV,YAAJ,GAAmBO,IAAIP,YAAJ,CAAiB,CAAjB,CAAnB;AACAU,oBAAIT,IAAJ,GAAWM,IAAIN,IAAJ,CAAS,CAAT,EAAYU,KAAZ,CAAkB,GAAlB,CAAX;AACAD,oBAAIR,WAAJ,GAAkB,IAAlB;AACAQ,oBAAIP,YAAJ,GAAoBI,IAAIJ,YAAJ,IAAoBI,IAAIJ,YAAJ,CAAiBS,MAAjB,GAA0B,CAA/C,GAAoDL,IAAIJ,YAAJ,CAAiB,CAAjB,EAAoBU,UAApB,CAA+BC,GAA/B,CAAmC;AAAA,yBAAKC,EAAE,GAAF,EAAOpB,EAAZ;AAAA,iBAAnC,CAApD,GAAyG,EAA5H;;iDAEOe,G;;;;;8DAGqCN,K;;;;;;;;;;;;;;;;;;;8EAI1BY,I;;;;;kDACb,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,sBAAI;AACF,wBAAIT,MAAM,IAAIhB,UAAJ,EAAV;AACAgB,wBAAIf,EAAJ,GAASqB,KAAKI,EAAd;AACAV,wBAAId,OAAJ,GAAc,8BAAoBoB,KAAKK,OAAzB,CAAd;AACAX,wBAAIb,OAAJ,GAAc,CAACmB,KAAKM,OAAN,CAAd;AACAZ,wBAAIZ,WAAJ,GAAkBkB,KAAKO,WAAvB;AACAb,wBAAIX,OAAJ,GAAciB,KAAKQ,OAAnB;AACAd,wBAAIV,YAAJ,GAAmBgB,KAAKS,YAAxB;AACAf,wBAAIT,IAAJ,GAAWe,KAAKU,IAAL,GAAYV,KAAKU,IAAL,CAAUf,KAAV,CAAgB,GAAhB,CAAZ,GAAmC,EAA9C;AACAD,wBAAIR,WAAJ,GAAkB,KAAlB;AACAQ,wBAAIP,YAAJ,GAAmBa,KAAKW,YAAL,GAAoBX,KAAKW,YAAL,CAAkBhB,KAAlB,CAAwB,GAAxB,CAApB,GAAmD,EAAtE;;AAEAO,4BAAQR,GAAR;AACD,mBAbD,CAcA,OAAOkB,CAAP,EAAU;AACRT,2BAAOS,CAAP;AACD;AACF,iBAlBM,C;;;;;;;;;;;;;;;;;;;;;kBAtCUlC,U","file":"PackageRef.js","sourcesContent":["import xml from \"./sys/xml\"\n\nimport SemanticVersion from \"./SemanticVersion\"\n\nexport default class PackageRef {\n\n  constructor() {\n    this.id = \"\";\n    this.version = new SemanticVersion(\"0\");\n    this.authors = [];\n    this.description = \"\";\n    this.summary = \"\";\n    this.releaseNotes = \"\";\n    this.tags = [];\n    this.isInstalled = false;\n    this.dependencies = [];\n  }\n\n  static async fromMspec(mspec) {\n    try {\n      let json = await xml.toJson(mspec);\n      let pkg = json.package.metadata[0];\n\n      let res = new PackageRef();\n      res.id = pkg.id[0];\n      res.version = new SemanticVersion(pkg.version[0]);\n      res.authors = pkg.authors;\n      res.description = pkg.description[0];\n      res.summary = pkg.summary[0];\n      res.releaseNotes = pkg.releaseNotes[0];\n      res.tags = pkg.tags[0].split(\" \");\n      res.isInstalled = true;\n      res.dependencies = (pkg.dependencies && pkg.dependencies.length > 0) ? pkg.dependencies[0].dependency.map(d => d[\"$\"].id) : [];\n\n      return res;\n    }\n    catch (e) {\n      throw `could not map mspec to PackageRef: ${mspec}`\n    }\n  }\n\n  static async fromFeed(feed) {\n    return new Promise((resolve, reject) => {\n      try {\n        let res = new PackageRef();\n        res.id = feed.Id;\n        res.version = new SemanticVersion(feed.Version);\n        res.authors = [feed.Authors];\n        res.description = feed.Description;\n        res.summary = feed.Summary;\n        res.releaseNotes = feed.ReleaseNotes;\n        res.tags = feed.Tags ? feed.Tags.split(\" \") : [];\n        res.isInstalled = false;\n        res.dependencies = feed.Dependencies ? feed.Dependencies.split(\"|\") : [];\n\n        resolve(res);\n      }\n      catch (e) {\n        reject(e);\n      }\n    })\n  }\n\n}"]}